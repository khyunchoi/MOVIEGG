{% extends 'base.html' %}

{% block style %}
<style>

.big_img {
  width: 100px;
  height: 100px;
  border-radius: 70%;
  overflow: hidden;
}

.wrapper {
  display: grid;
  grid-template-columns: repeat(3, 1fr);
  grid-gap: 10px;
  grid-auto-rows: minmax(100px, auto);
}

.one {
  grid-column: 1 / 3;
  grid-row: 1;
}

.two {
  grid-column: 2 / 4;
  grid-row: 1 / 3;
}

.three {
  grid-column: 1;
  grid-row: 2 / 5;
}

.articles-content {
  height: 1000px;
  width: 100%;
  display: flex;
  justify-content: center;
  align-items: center;
}

.articles-content-box {
  height: 700px;
  width: 90%;
  background-color: white;
}

.articles-content-table {
  width: 100%;
  height: 85%;
}

.articles-table-center {
  text-align: center;
}

tr {
  border-bottom: 1px solid #C5CBD0;
  height: 60px;
}
</style>
{% endblock style %}

{% block content %}

<div class="wrapper">
  <div class="one">
    <div>
      {% if user.profile_image %}
        <img src="{{ person.profile_image.url }}" alt="" class="big_img">
      {% else %}
        <svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" fill="currentColor" class="bi bi-person-circle" viewBox="0 0 16 16">
          <path d="M11 6a3 3 0 1 1-6 0 3 3 0 0 1 6 0z"/>
          <path fill-rule="evenodd" d="M0 8a8 8 0 1 1 16 0A8 8 0 0 1 0 8zm8-7a7 7 0 0 0-5.468 11.37C3.242 11.226 4.805 10 8 10s4.757 1.225 5.468 2.37A7 7 0 0 0 8 1z"/>
        </svg>
      {% endif %}
    </div>
    <br>
    {{ request.user.username }}
    LV . {{ request.user.exp }}
    <li>1</li>
    <li>2</li>
    <li>3</li>
    <li>4</li>
    <li>5</li>
    <li>1</li>
    <li>2</li>
    <li>3</li>
    <li>4</li>
    <li>5</li>
  </div>

  <div class="two">
    <div class="d-flex justify-content-center">
      <h2>내가 쓴 글 모음</h2>
    </div>
    <div class="d-flex justify-content-evenly">
      <a class="btn mt-3 mb-1 mx-3 text-muted" href="{% url 'accounts:profile_review' request.user.pk %}" role="button" style="background-color: #F3F5F7; width: 140px; height: 45px;"><strong>리뷰게시판</strong></a>
      <a class="btn mt-3 mb-1 mx-3 text-black border-bottom border-4" href="{% url 'accounts:profile_freeboard' request.user.pk %}" role="button" style="background-color: #F3F5F7; width: 140px; height: 45px;"><strong>자유게시판</strong></a>
    </div>

    <div class="articles-content">
      <div class="articles-content-box">
        <table class="articles-content-table border-collapse: collapse;">
          <thead>
            <tr>
              <th class="articles-table-center" style="width:10%; padding: 15px 0;">
                <span>번호</span>
              </th>
              <th class="articles-table-center" style="width:45%">
                <span>제목</span>
              </th>
              <th class="articles-table-center" style="width:15%">
                <span>등록일</span>
              </th>
              <th class="articles-table-center" style="width:10%">
                <span>조회수</span>
              </th>
              <th class="articles-table-center" style="width:10%">
                <span>추천수</span>
              </th>
            </tr>
          </thead>
          <tbody>
            {% for freeboard in request.user.freeboard_set.all %}
              <tr>
                <td class="articles-table-center">
                  <span>{{ freeboard.pk }}</span>
                </td>
                <td>
                  <a style="text-decoration: none; color: #484848;" href="{% url 'articles:freeboard_detail' freeboard.pk %}">
                    <div style="font-size: 20px;">
                      {% if freeboard.title|length > 20 %}
                        <span>{{ freeboard.title|slice:":20" }}...</span>
                      {% else %}
                        <span>{{ freeboard.title }}</span>
                      {% endif %}
                    </div>
                  </a>
                </td>
                <td class="articles-table-center">
                  <span>{{ freeboard.created_at.date.year }}-{{ freeboard.created_at.date.month }}-{{ freeboard.created_at.date.day }}</span>
                </td>
                <td class="articles-table-center">
                  <span>{{ freeboard.hit }}</span>
                </td>
                <td class="articles-table-center">
                  <span>{{ freeboard.like_users.count }}</span>
                </td>
              </tr>
            {% endfor %}

            {% if page_number == page_obj.paginator.num_pages %}
              {% for _ in n %}
                <tr>
                </tr>
              {% endfor %}
            {% endif %}
          </tbody>
        </table>

        <div class="d-flex justify-content-between align-items-center" style="height: calc(700px - 85%); background-color: #F1F1F1;">
          <div style="margin-left: 25px;"></div>
          <nav aria-label="Page navigation example">
            <ul class="pagination">
              {% if page_obj.has_previous %}
                <li class="page-item"><a class="page-link" href="?page={{ page_obj.previous_page_number }}">Previous</a></li>
              {% else %}
                <li class="page-item disabled"><a class="page-link">Previous</a></li>
              {% endif %}

              {% for num in page_obj.paginator.page_range %}
                {% if num == page_number %}
                  <li class="page-item active"><a class="page-link" href="?page={{ num }}">{{ num }}</a></li>
                {% else %}
                  <li class="page-item"><a class="page-link" href="?page={{ num }}">{{ num }}</a></li>
                {% endif %}
              {% endfor %}

              {% if page_obj.has_next %}
                <li class="page-item"><a class="page-link" href="?page={{ page_obj.next_page_number }}">Next</a></li>
              {% else %}
                <li class="page-item disabled"><a class="page-link">Next</a></li>
              {% endif %}
            </ul>
          </nav>
          <div style="margin-right: 20px;">
            <a class="btn" style="background-color: #4285F4; color: white;" href="{% url 'articles:freeboard_create' %}">글쓰기</a>
          </div>
        </div>
      </div>
    </div>  
  </div>
  
  <div class="three">
    <h1>나에게 달린 최근 댓글 모음</h1>
    {% for freeboard in request.user.freeboard_set.all %}
      {% for comment in freeboard.freecomment_set.all %}
        <div class="d-flex my-4">
          {{ comment.user.nickname }} {{ comment.content }}
        </div>
      {% endfor %}
    {% endfor %}
  </div>
</div>
{% endblock content %}